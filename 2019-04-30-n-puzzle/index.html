<!DOCTYPE html>
<html lang='zh-SC'>

<head>
  <meta name="generator" content="Hexo 5.4.2">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://cdn.jsdelivr.net'>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  <title>N 数码问题 - Stingray</title>

  
    <meta name="description" content="问题描述 N &#x3D; 24：在一个 5×5 的棋盘上，有 24 个写有数字（1-24）的棋子以及一个空格（由 0 表示）。与一般的 N 数码问题不同，棋盘的边缘设置了两组连通点，(0, 2) 与 (4, 2)（蓝色）上下互通，(2, 0) 与 (4, 0)（红色）左右互通。从文件读取初始状态和目标状态的二维矩阵，输出空格0的最短路径（用UDLR表示上下左右移动）。 棋盘示意图 状态的定义">
<meta property="og:type" content="article">
<meta property="og:title" content="N 数码问题">
<meta property="og:url" content="https://jilstingray.github.io/2019-04-30-n-puzzle/index.html">
<meta property="og:site_name" content="Stingray">
<meta property="og:description" content="问题描述 N &#x3D; 24：在一个 5×5 的棋盘上，有 24 个写有数字（1-24）的棋子以及一个空格（由 0 表示）。与一般的 N 数码问题不同，棋盘的边缘设置了两组连通点，(0, 2) 与 (4, 2)（蓝色）上下互通，(2, 0) 与 (4, 0)（红色）左右互通。从文件读取初始状态和目标状态的二维矩阵，输出空格0的最短路径（用UDLR表示上下左右移动）。 棋盘示意图 状态的定义">
<meta property="og:locale" content="zh_SC">
<meta property="og:image" content="https://jilstingray.github.io/assets/2019-04-30-n-puzzle/1.jpg">
<meta property="article:published_time" content="2019-04-29T16:00:00.000Z">
<meta property="article:modified_time" content="2023-11-03T11:00:57.381Z">
<meta property="article:author" content="jilstingray">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jilstingray.github.io/assets/2019-04-30-n-puzzle/1.jpg">
  
  

  <!-- feed -->
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  

  
    
      <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
    
  
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body>
  


  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    


<header class="header">

<div class="logo-wrap"><a class="title" href="/"><div class="main">Stingray</div></a></div>
<nav class="menu dis-select"><a class="nav-item active" href="/">文章</a><a class="nav-item" href="/projects/">项目</a><a class="nav-item" href="/about/">关于</a></nav></header>

<div class="widgets">

<div class="widget-wrap single" id="toc"><div class="widget-header cap dis-select"><span class="name">本文目录</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="toc-text">问题描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">状态的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8F%91%E5%BC%8F%E5%87%BD%E6%95%B0"><span class="toc-text">启发式函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a-best-first-search"><span class="toc-text">A*: best-first search</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E6%8F%8F%E8%BF%B0-python"><span class="toc-text">算法描述 (Python)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c-%E5%AE%9E%E7%8E%B0"><span class="toc-text">C++ 实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ida-deep-first-search"><span class="toc-text">IDA*: deep-first search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-text">完整代码</span></a></li></ol></div></div></div>


</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" title="GitHub" href="https://github.com/jilstingray" target="_blank" rel="external nofollow noopener noreferrer"><i class="ri-github-line ri-lg"></i></a><a class="social" title="Steam" href="https://steamcommunity.com/id/stingray_117/" target="_blank" rel="external nofollow noopener noreferrer"><i class="ri-steam-fill ri-lg"></i></a><a class="social" title="Keylol" href="https://keylol.com/suid-1406507" target="_blank" rel="external nofollow noopener noreferrer"><i class="ri-discuss-line ri-lg"></i></a></div></footer>

    </aside>
    <div class='l_main'>
      

      


<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">Stingray</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a></div><div id="post-meta">发布于&nbsp;<time datetime="2019-04-29T16:00:00.000Z">2019-04-30</time></div></div>

<article class='content md post reveal'>
<h1 class="article-title"><span>N 数码问题</span></h1>
<h2 id="问题描述">问题描述</h2>
<p>N = 24：在一个 5×5 的棋盘上，有 24
个写有数字（1-24）的棋子以及一个空格（由 0 表示）。与一般的 N
数码问题不同，棋盘的边缘设置了两组<strong>连通点</strong>，(0, 2) 与 (4,
2)（蓝色）上下互通，(2, 0) 与 (4,
0)（红色）左右互通。从文件读取初始状态和目标状态的二维矩阵，输出空格0的最短路径（用UDLR表示上下左右移动）。</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="../assets/2019-04-30-n-puzzle/1.jpg" alt="棋盘示意图"></div><div class="image-meta"><span class="image-caption center">棋盘示意图</span></div></div>
<h2 id="状态的定义">状态的定义</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Status</span> {</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">// 5*5棋盘</span></span><br><span class="line">	<span class="keyword">int</span> grid[<span class="number">25</span>];</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">// 上一步移动的方向</span></span><br><span class="line">	<span class="keyword">char</span> prev;</span><br><span class="line">	<span class="comment">// 路径耗散</span></span><br><span class="line">	<span class="keyword">int</span> cost;</span><br><span class="line">	<span class="comment">// 优先级=路径耗散+启发式函数</span></span><br><span class="line">	<span class="keyword">double</span> f;</span><br><span class="line">	<span class="comment">// close表中的前一状态</span></span><br><span class="line">	<span class="keyword">int</span> parent;</span><br><span class="line">	<span class="built_in">Status</span>(<span class="keyword">int</span> b[], <span class="keyword">int</span> goal[] = TYPE_STD, <span class="keyword">char</span> pv = <span class="string">'X'</span>, <span class="keyword">int</span> c = <span class="number">0</span>, <span class="keyword">int</span> p = <span class="number">-1</span>):<span class="built_in">prev</span>(pv), <span class="built_in">cost</span>(c), <span class="built_in">parent</span>(p) {</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">25</span>; i++) {</span><br><span class="line">            grid[i] = b[i];</span><br><span class="line">        }</span><br><span class="line">		f = cost + <span class="built_in">h</span>(goal);</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// 启发式函数</span></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">h</span><span class="params">(<span class="keyword">int</span> goal[] = TYPE_STD)</span></span>;</span><br><span class="line">	<span class="comment">// 交换数字</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>;</span><br><span class="line">	<span class="comment">// 移动空格</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> m)</span></span>;</span><br><span class="line">	<span class="comment">// 打印grid</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">// 比较grid</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">compare</span><span class="params">(Status S)</span></span>;</span><br><span class="line">	<span class="comment">// status是否在open表</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">is_open</span><span class="params">(list&lt;Status&gt; open)</span></span>;</span><br><span class="line">	<span class="comment">// status是否在close表</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">is_close</span><span class="params">(vector&lt;Status&gt; close)</span></span>;</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h2 id="启发式函数">启发式函数</h2>
<p>连通点的存在，导致空格0可以从这些连通点之间抄近路，仅仅对这个 5*5
的区域计算 Manhattan 距离作为启发式函数是不可行的：真实的 Manhattan
距离可能要比这个值小。但是错位棋子数 (misplaced tiles)
并不会受到连通点的影响。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Status::h</span><span class="params">(<span class="keyword">int</span> goal[])</span> </span>{</span><br><span class="line">	<span class="keyword">double</span> value = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">25</span>; i++)</span><br><span class="line">		<span class="keyword">if</span> (grid[i] != goal[i] &amp;&amp; grid[i] != <span class="number">0</span>)</span><br><span class="line">			value++;</span><br><span class="line">	<span class="keyword">return</span> value;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="a-best-first-search">A*: best-first search</h2>
<p>A*
算法本质上是一种改进的最佳优先搜索。一般的最佳优先搜索以每个状态到终点的距离作为优先级，每次始终选取离终点最近的状态进行扩展，这种算法在起点和终点之间存在障碍物时可能找不到最短路径。</p>
<p>A*
算法用“路径耗散+启发式函数”表示优先级，每次都从所有可到达的后继状态中选取优先级最高、即
<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="19.068ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8428 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(939,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(1584,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2250.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(3306.6,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mo" transform="translate(3783.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4172.6,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(4817.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5428.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(6429,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mo" transform="translate(7005,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7394,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(8039,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span> 最小的状态 S
作为下一个遍历的状态。</p>
<p>为了实现最佳优先，A* 算法要维护 <code>open</code> 和
<code>close</code>两个表，<code>open</code>
存储待扩展的状态，<code>close</code> 存储已扩展的状态，每一步都从
<code>open</code> 中取出优先级最高的状态并放入 <code>close</code>
中。为了实现这一点，<code>open</code> 可以使用优先队列，按照 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="4.464ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1973 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(939,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(1584,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span> 值从小到大排列，每次只需要
<code>pop</code> 出队列的 <code>head</code> 状态即可。</p>
<p>在 A*
算法中，如果有两条不同的路径到达同一个状态，且新路径的优先级比旧路径更高，那么是允许重复访问这个状态的，而允许重复访问
<code>close</code> 的内容会导致 <code>close</code> 无限制地增长。</p>
<h3 id="算法描述-python">算法描述 (Python)</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">best_first_graph_search</span>(<span class="params">problem, f</span>):</span></span><br><span class="line">	<span class="string">""" 最佳优先搜索 """</span></span><br><span class="line">	<span class="comment"># 获取初始状态</span></span><br><span class="line">    status = Status(problem.init)</span><br><span class="line">    status.f_func = f(status)</span><br><span class="line">    open_list = PriorityQueue(<span class="string">'min'</span>, f)</span><br><span class="line">	<span class="comment"># 初始状态加入open_list</span></span><br><span class="line">    close_list = <span class="built_in">set</span>()</span><br><span class="line">    open_list.put(status)				</span><br><span class="line">    <span class="keyword">while</span> open_list.items != []:</span><br><span class="line">		<span class="comment">## pop open_list</span></span><br><span class="line">        status = open_list.get()</span><br><span class="line">        <span class="keyword">if</span> problem.goal_test(status) == <span class="literal">True</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\nsteps: %d\n"</span> % steps)</span><br><span class="line">			<span class="comment"># head==目标状态，返回</span></span><br><span class="line">            <span class="keyword">return</span> status</span><br><span class="line">		<span class="comment"># 否则加入close_list		</span></span><br><span class="line">        close_list.add(status.state)</span><br><span class="line">		<span class="comment">## 状态扩展 </span></span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> status.expand(problem):</span><br><span class="line">			<span class="comment">## 若后继状态不在open和close中，将其加入open</span></span><br><span class="line">            <span class="keyword">if</span> child.state <span class="keyword">not</span> <span class="keyword">in</span> close_list <span class="keyword">and</span> child <span class="keyword">not</span> <span class="keyword">in</span> open_list:</span><br><span class="line">                open_list.put(child)</span><br><span class="line">			<span class="comment">## 若后继状态在open中且优先级更高，将open中的状态替换</span></span><br><span class="line">            <span class="keyword">elif</span> child <span class="keyword">in</span> open_list:</span><br><span class="line">                <span class="keyword">if</span> f(child) &lt; f(open_list[child]):</span><br><span class="line">                    <span class="keyword">del</span> open_list[child]</span><br><span class="line">                    open_list.put(child)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">astar_search</span>(<span class="params">problem, func</span>):</span></span><br><span class="line">	<span class="string">"""A*算法：最佳优先搜索，f=cost+启发式函数"""</span></span><br><span class="line">    h = problem.h_func</span><br><span class="line">    <span class="keyword">return</span> best_first_graph_search(problem, <span class="keyword">lambda</span> S: S.path_cost + h(S, func))</span><br></pre></td></tr></table></figure>
<h3 id="c-实现">C++ 实现</h3>
<ul>
<li><p>使用 <code>std::list</code> 实现优先队列 <code>open</code>，定义
<code>insert_open()</code>
进行优先级排序插入，<code>Status.is_open()</code> 进行查找（只比较
<code>Status.grid</code>）。<code>std::list</code>
类似于双向链表，可以从任何位置插入/删除元素。</p></li>
<li><p>使用 <code>std::vector</code> 实现 <code>close</code>，将
<code>push_back()</code> 重新封装为
<code>insert_close()</code>，增加返回插入位置（下标）的功能，便于访问。定义
<code>Status.is_close()</code> 进行查找（只比较
<code>Status.grid</code>）。</p></li>
<li><p><code>expand()</code>
扩展当前状态，遍历空格的合法移动方向，得到相应的后继状态，更新
<code>open</code> 和 <code>close</code>。</p></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A* algorithm</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">a_star</span><span class="params">(<span class="keyword">int</span> init[], <span class="keyword">int</span> goal[], vector&lt;<span class="keyword">char</span>&gt;&amp; path)</span> </span>{</span><br><span class="line">	<span class="comment">// 获取初始状态</span></span><br><span class="line">	<span class="function">Status <span class="title">S</span><span class="params">(init, goal)</span></span>;</span><br><span class="line">	<span class="function">Status <span class="title">G</span><span class="params">(goal, goal)</span></span>;</span><br><span class="line">	list&lt;Status&gt; open;</span><br><span class="line">	vector&lt;Status&gt; close;</span><br><span class="line">	<span class="comment">// 初始状态加入open</span></span><br><span class="line">	open.<span class="built_in">push_back</span>(S);</span><br><span class="line">	<span class="keyword">while</span> (!open.<span class="built_in">empty</span>()) {</span><br><span class="line">		<span class="comment">// 若head==goal，返回</span></span><br><span class="line">		<span class="keyword">if</span>(open.<span class="built_in">front</span>().<span class="built_in">compare</span>(G)) {</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"Search successed. Steps = %d\n"</span>, step);</span><br><span class="line">			<span class="built_in">get_path</span>(open.<span class="built_in">front</span>(), close, path);</span><br><span class="line">			open.<span class="built_in">clear</span>();</span><br><span class="line">			close.<span class="built_in">clear</span>();</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="comment">// 否则，扩展当前状态</span></span><br><span class="line">		<span class="built_in">expand</span>(open, close, goal);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展当前状态</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">expand</span><span class="params">(list&lt;Status&gt; &amp;open, vector&lt;Status&gt; &amp;close, <span class="keyword">int</span> goal[])</span> </span>{</span><br><span class="line">	Status S = open.<span class="built_in">front</span>();</span><br><span class="line">	<span class="comment">// 将open的head加入close并得到下标</span></span><br><span class="line">	<span class="keyword">int</span> index = <span class="built_in">insert_close</span>(S, close);</span><br><span class="line">	<span class="comment">// 弹出open队首</span></span><br><span class="line">	open.<span class="built_in">pop_front</span>();					</span><br><span class="line">	<span class="comment">// 尝试S的四个方向的后继状态N</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">		Status N = S;</span><br><span class="line">		<span class="keyword">if</span>(!N.<span class="built_in">move</span>(i))</span><br><span class="line">			<span class="keyword">continue</span>;	<span class="comment">// 跳过非法状态</span></span><br><span class="line">		N.prev = actions[i];</span><br><span class="line">		N.cost = S.cost + <span class="number">1</span>;</span><br><span class="line">		N.f = N.cost + N.<span class="built_in">h</span>(goal);</span><br><span class="line">		N.parent = index;</span><br><span class="line">		<span class="comment">// 若N在open中</span></span><br><span class="line">		<span class="keyword">if</span> (N.<span class="built_in">is_open</span>(open)) {</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = open.<span class="built_in">begin</span>(); it != open.<span class="built_in">end</span>(); it++) {</span><br><span class="line">				<span class="keyword">if</span> (N.<span class="built_in">compare</span>(*it)) {</span><br><span class="line">					<span class="comment">// N优先级低，不替换</span></span><br><span class="line">					<span class="keyword">if</span> (N.f &gt; (*it).f)</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="comment">// 若新的N优先级更高，将open中的状态删除...</span></span><br><span class="line">					<span class="keyword">else</span> {</span><br><span class="line">						open.<span class="built_in">erase</span>(it);</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					}</span><br><span class="line">				}</span><br><span class="line">				<span class="comment">// ...然后将N插入open</span></span><br><span class="line">				<span class="keyword">if</span> (N.f &lt; (*it).f)</span><br><span class="line">					open.<span class="built_in">insert</span>(it, N);</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="comment">// 否则，若N在close中（已扩展过）</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (N.<span class="built_in">is_close</span>(close))</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; close.<span class="built_in">size</span>(); j++)</span><br><span class="line">				<span class="comment">// 若新的N优先级更高，替换，并将N插入open等待重新扩展</span></span><br><span class="line">				<span class="keyword">if</span>(N.<span class="built_in">compare</span>(close[j]) &amp;&amp; N.f &lt; close[j].f) {</span><br><span class="line">					close[j].cost = N.cost;</span><br><span class="line">					close[j].f = N.f;</span><br><span class="line">					<span class="built_in">insert_open</span>(N, open);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">		<span class="comment">// 若N既不在open中也不在close中，将N插入open</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">insert_open</span>(N, open);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="ida-deep-first-search">IDA*: deep-first search</h2>
<p>IDA*
是一种有界深度优先搜索。本问题用初始状态的启发式函数作为搜索的限制深度，当搜索从初始状态出发，沿某一路径扩展到限制深度时还没有找到目标状态，就不再继续扩展，而是改变搜索方向。这种方法也被称为“剪枝”。若在当前界限内找不到问题的解，则增大限制深度。</p>
<p>与 A* 不同，IDA* 不需要维护 <code>open</code> 和 <code>close</code>
两个表，减少了内存占用，也降低了复杂数据结构带来的实现难度。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 移动方向</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> actions[] = { <span class="string">'U'</span>, <span class="string">'D'</span>, <span class="string">'L'</span>, <span class="string">'R'</span> };</span><br><span class="line"><span class="comment">// 反方向</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> opposite[] = { <span class="string">'D'</span>, <span class="string">'U'</span>, <span class="string">'R'</span>, <span class="string">'L'</span> };</span><br><span class="line"><span class="comment">// infinity</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1000</span>;</span><br><span class="line"><span class="comment">// IDA*最大搜索深度</span></span><br><span class="line"><span class="keyword">int</span> bound = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// IDA*空格移动路径</span></span><br><span class="line"><span class="keyword">char</span> path_str[INF];</span><br><span class="line"></span><br><span class="line"><span class="comment">// DFS</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">depth_first</span><span class="params">(Status S, <span class="keyword">int</span> goal[], <span class="keyword">int</span> depth, <span class="keyword">char</span> act)</span> </span>{</span><br><span class="line">	<span class="function">Status <span class="title">G</span><span class="params">(goal, goal)</span></span>;</span><br><span class="line">	<span class="comment">// 当前状态==目标状态，返回</span></span><br><span class="line">	<span class="keyword">if</span>(S.<span class="built_in">compare</span>(G)) {</span><br><span class="line">		path_str[depth] = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// 超出限制深度，剪枝</span></span><br><span class="line">	<span class="keyword">if</span> (S.f - S.cost + depth &gt; bound)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="comment">// 搜索</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) {</span><br><span class="line">		<span class="comment">// 回到前一方向，剪枝</span></span><br><span class="line">		<span class="keyword">if</span> (actions[i] == act)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		Status N = S;</span><br><span class="line">		<span class="comment">// 跳过非法方向</span></span><br><span class="line">		<span class="keyword">if</span> (!N.<span class="built_in">move</span>(i))</span><br><span class="line">			<span class="keyword">continue</span>;	</span><br><span class="line">		<span class="comment">// 获取合法方向的后继N</span></span><br><span class="line">		N.prev = actions[i];</span><br><span class="line">		N.cost = S.cost + <span class="number">1</span>;</span><br><span class="line">		N.f = N.cost + N.<span class="built_in">h</span>(goal);</span><br><span class="line">		path_str[depth] = actions[i];</span><br><span class="line">		<span class="comment">// 递归</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">depth_first</span>(N, goal, depth + <span class="number">1</span>, opposite[i]))</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// IDA*</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ida_star</span><span class="params">(<span class="keyword">int</span> init[], <span class="keyword">int</span> goal[], vector&lt;<span class="keyword">char</span>&gt; &amp;path)</span> </span>{</span><br><span class="line">	<span class="comment">// 得到初始状态</span></span><br><span class="line">	<span class="function">Status <span class="title">S</span><span class="params">(init, goal)</span></span>;</span><br><span class="line">	<span class="comment">// 获取限制深度	</span></span><br><span class="line">	bound = S.<span class="built_in">h</span>(goal);</span><br><span class="line">	<span class="built_in">memset</span>(path_str, <span class="string">'X'</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>[INF]));</span><br><span class="line">	<span class="comment">// DFS，搜索失败时增大限制深度</span></span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">depth_first</span>(S, goal, <span class="number">0</span>, <span class="string">'X'</span>))</span><br><span class="line">		bound++;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Search successed.\n"</span>);</span><br><span class="line">	<span class="comment">// 存储最优路径</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; INF &amp;&amp; path_str[i] != <span class="string">'\0'</span>; i++)</span><br><span class="line">		path.<span class="built_in">push_back</span>(path_str[i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="完整代码">完整代码</h2>
<div class="tag-plugin link dis-select"><a class="link-card" title="snippets/puzzle" href="https://github.com/jilstingray/snippets/tree/main/puzzle" target="_blank" rel="external nofollow noopener noreferrer"><div class="left"><span class="title fs14">snippets/puzzle</span><span class="url fs12">https://github.com/jilstingray/snippets/tree/main/puzzle</span></div><div class="right"><div class="lazy img" data-bg="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/link/8f277b4ee0ecd.svg"></div></div></a></div>


<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a
target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享
4.0 国际</a> 许可协议，转载请注明出处。</p>
</div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="header cap theme"><span>接下来阅读</span></section><section class="body fs14"><div class="line"></div><a id="prev" href="/2021-10-22-sort/">基本排序算法<span class="note">较新</span></a><div class="line"></div><a id="more" href="/archives">检索全部文章</a></section></div>








      
<footer class="page-footer reveal fs12"><hr><div class="text"><p>本博客所有文章除特别声明外，均采用 <a
target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA
4.0</a> 许可协议，转载请注明出处。</p>
<p>本站由 <a href="https://jilstingray.github.io/"><span
class="citation" data-cites="jilstingray">@jilstingray</span></a>
创建，使用 <a
target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.5.1"
title="v1.5.1">Stellar</a> 作为主题。</p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.5.1';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js',
    sitesjs: '/js/plugins/sites.js',
    friendsjs: '/js/plugins/friends.js',
  };

  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.3.1/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper/swiper-bundle.min.css","js":"https://unpkg.com/swiper/swiper-bundle.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":true,"js":"https://cdn.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
